// prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum UserRole {
  anakremas
  koordinator_anakremas
  orangtuawali
  marbot
  takmir
  admin
}

model User {
  id            String    @id @default(cuid())
  name          String
  username      String    @unique
  email         String    @unique
  password      String
  role          UserRole
  active        Boolean   @default(true)
  groupId       String?
  // New fields for profile
  avatar        String?   @default("/avatars/avatar-01.jpg")
  tanggalLahir  DateTime?
  nomerWhatsapp String?
  alamatRumah   String?
  rwRumah       String?
  rtRumah       String?
  sekolah       String?
  keterangan    String?
  // Timestamps
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  orangTuaAnakRemasAsOrangTua    OrangTuaAnakRemas[] @relation("orangTua")
  orangTuaAnakRemasAsAnakRemas   OrangTuaAnakRemas[] @relation("anakRemas")

  @@map("users")
}

model OrangTuaAnakRemas {
  id          String   @id @default(cuid())
  orangTuaId  String
  anakRemasId String
  createdAt   DateTime @default(now())
  
  orangTua  User @relation("orangTua", fields: [orangTuaId], references: [id])
  anakRemas User @relation("anakRemas", fields: [anakRemasId], references: [id])

  @@unique([orangTuaId, anakRemasId])
  @@map("orang_tua_anak_remas")
}
